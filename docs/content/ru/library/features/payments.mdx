---
title: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
description: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π WayForPay, –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —á–ª–µ–Ω—Å—Ç–≤–∞ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
---

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π WayForPay –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è —á–ª–µ–Ω—Å—Ç–≤–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º—É–ª—å—Ç–∏-–≤–∞–ª—é—Ç—ã.

## –û–±–∑–æ—Ä

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ Ring –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å **WayForPay** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è:

- **–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —á–ª–µ–Ω—Å—Ç–≤–∞**: SUBSCRIBER ‚Üí MEMBER (‚Ç¥299 UAH)
- **–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ**: –ü–ª–∞—Ç–µ–∂–∏ –≤ –º—É–ª—å—Ç–∏-–≤–µ–Ω–¥–æ—Ä–Ω–æ–º –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ
- **–ú—É–ª—å—Ç–∏-–≤–∞–ª—é—Ç–∞**: UAH –æ—Å–Ω–æ–≤–Ω–∞—è, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—Ä–∏–ø—Ç–æ-–∫–æ—à–µ–ª—å–∫–æ–≤
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: PCI DSS —Å–æ–≤–º–µ—Å—Ç–∏–º–æ, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WayForPay

**–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è —É–∫—Ä–∞–∏–Ω—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞**

<Code language="typescript" title="interface WayForPayConfig {">
{`merchantAccount: string
  secretKey: string
  domainName: string
  webhookUrl: string
}`}
</Code>

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã
- üí≥ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã**: Visa, MasterCard
- üì± **–¶–∏—Ñ—Ä–æ–≤—ã–µ –∫–æ—à–µ–ª—å–∫–∏**: Apple Pay, Google Pay
- üè¶ **–ë–∞–Ω–∫–∏–Ω–≥**: Privat24, LiqPay
- üìÖ **–†–∞—Å—Å—Ä–æ—á–∫–∞**: PayParts, –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–∞—Å—Å—Ä–æ—á–∫–∞
- üì± **QR-–∫–æ–¥**: –ü–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ QR-–∫–æ–¥

### –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Web3 –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ RING**

<Code language="typescript" title="interface CryptoPayment {">
{`networks: ['Polygon', 'Ethereum']
  tokens: ['RING', 'MATIC', 'ETH']
  features: ['Non-custodial', 'Automatic conversion']
}`}
</Code>

## –ü–æ—Ç–æ–∫ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è —á–ª–µ–Ω—Å—Ç–≤–∞

### –ü—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

<Mermaid>
{`sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (SUBSCRIBER)
    participant R as Ring Platform
    participant W as WayForPay
    participant D as Database

    U->>R: –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å —Å—É—â–Ω–æ—Å—Ç—å"
    R->>R: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    R->>U: –ü–æ–∫–∞–∑–∞—Ç—å MembershipUpgradeModal
    U->>R: –ù–∞–∂–∞—Ç—å "–ü–æ–≤—ã—Å–∏—Ç—å —Å–µ–π—á–∞—Å"
    R->>R: –°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–µ—Å—Å–∏—é
    R->>W: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É WayForPay
    W->>U: –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–ª–∞—Ç–µ–∂–Ω—É—é —Ñ–æ—Ä–º—É
    U->>W: –í–≤–µ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    W->>W: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç–µ–∂
    W->>R: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ webhook
    R->>R: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å
    R->>U: –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞
    R->>D: –ü–æ–≤—ã—Å–∏—Ç—å SUBSCRIBER ‚Üí MEMBER`}
</Mermaid>

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–ª–∞—Ç–µ–∂–∞

<Code language="typescript" title="'use client'">
{`import { useState } from 'react'
import { createPaymentSession } from '@/actions/payments'

export function MembershipUpgradeModal() {
  const [isProcessing, setIsProcessing] = useState(false)

  const handleUpgrade = async () => {
    setIsProcessing(true)

    const paymentUrl = await createPaymentSession({
      amount: 299,
      currency: 'UAH',
      productName: '–ü–æ–≤—ã—à–µ–Ω–∏–µ —á–ª–µ–Ω—Å—Ç–≤–∞',
      returnUrl: '/payment/success',
      webhookUrl: '/api/payments/webhook'
    })

    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ WayForPay
    window.location.href = paymentUrl
  }

  return (
    <div className="modal">
      <h2>–ü–æ–≤—ã—Å–∏—Ç—å –¥–æ —Å—Ç–∞—Ç—É—Å–∞ MEMBER</h2>
      <div className="benefits">
        <h3>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</h3>
        <ul>
          <li>‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å—É—â–Ω–æ—Å—Ç—è–º–∏</li>
          <li>‚úÖ –î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º</li>
          <li>‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</li>
          <li>‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
        </ul>
      </div>
      <div className="pricing">
        <p className="price">‚Ç¥299 UAH</p>
        <p className="note">–ï–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂, –ø–æ–∂–∏–∑–Ω–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</p>
      </div>
      <button
        onClick={handleUpgrade}
        disabled={isProcessing}
        className="upgrade-button"
      >
        {isProcessing ? '–û–±—Ä–∞–±–æ—Ç–∫–∞...' : '–ü–æ–≤—ã—Å–∏—Ç—å —Å–µ–π—á–∞—Å'}
      </button>
    </div>
  )
}`}
</Code>

#### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ webhook

// app/api/payments/webhook/route.ts

<Code language="typescript" title="TypeScript">
{`import { NextRequest } from 'next/server'
import { verifyWayForPaySignature } from '@/lib/payments/wayforpay'
import { upgradeUserRole } from '@/lib/auth/role-upgrade'

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å WayForPay
    const isValid = verifyWayForPaySignature(body)
    if (!isValid) {
      return Response.json({ error: '–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å' }, { status: 400 })
    }

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
    if (body.transactionStatus === 'Approved') {
      await upgradeUserRole(body.orderReference, 'MEMBER')

      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      await sendUpgradeConfirmation(body.clientEmail)
    }

    // –û—Ç–≤–µ—Ç–∏—Ç—å WayForPay
    return Response.json({
      orderReference: body.orderReference,
      status: 'accept',
      time: Math.floor(Date.now() / 1000)
    })

  } catch (error) {
    console.error('–û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –Ω–µ —É–¥–∞–ª–∞—Å—å:', error)
    return Response.json({ error: '–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å' }, { status: 500 })
  }
}`}
</Code>

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ

### –ü–æ—Ç–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π –º—É–ª—å—Ç–∏-–≤–µ–Ω–¥–æ—Ä–∞

<Mermaid>
{`graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –∫–æ—Ä–∑–∏–Ω—É] --> B[–í—ã–±—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã]
    B --> C{WayForPay?}
    C -->|–î–∞| D[–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É WayForPay]
    C -->|–ù–µ—Ç| E{–ö—Ä–∏–ø—Ç–æ?}
    E -->|–î–∞| F[–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫]
    E -->|–ù–µ—Ç| G{–¢–æ–∫–µ–Ω—ã RING?}
    G -->|–î–∞| H[–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç–µ–∂ RING]

    D --> I[–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ WayForPay]
    I --> J[–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞]
    J --> K{–ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω?}
    K -->|–î–∞| L[–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞]
    K -->|–ù–µ—Ç| M[–ü–ª–∞—Ç–µ–∂ –Ω–µ —É–¥–∞–ª—Å—è]

    F --> N[–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∫–æ—à–µ–ª—å–∫–∞]
    N --> O[–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é]
    O --> P{–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ?}
    P -->|–î–∞| L
    P -->|–ù–µ—Ç| M

    H --> Q[–ü–µ—Ä–µ–≤–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤]
    Q --> R{–ü–µ—Ä–µ–≤–æ–¥ —É—Å–ø–µ—à–µ–Ω?}
    R -->|–î–∞| L
    R -->|–ù–µ—Ç| M

    L --> S[–°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—á–µ—Ç—ã —Å –≤–µ–Ω–¥–æ—Ä–∞–º–∏]
    S --> T[–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è]
    T --> U[–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞]`}
</Mermaid>

### API –ø–ª–∞—Ç–µ–∂–µ–π –º–∞–≥–∞–∑–∏–Ω–∞

// app/api/store/payments/wayforpay/route.ts

<Code language="typescript" title="TypeScript">
{`import { NextRequest } from 'next/server'
import { auth } from '@/auth'
import { createWayForPayPayment } from '@/lib/payments/store-payments'

export async function POST(request: NextRequest) {
  const session = await auth()

  if (!session?.user) {
    return Response.json({ error: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 })
  }

  try {
    const { orderId, amount, currency, products } = await request.json()

    const paymentUrl = await createWayForPayPayment({
      orderId,
      amount,
      currency,
      products,
      customer: {
        email: session.user.email,
        firstName: session.user.name?.split(' ')[0],
        lastName: session.user.name?.split(' ')[1]
      },
      returnUrl: `/store/order/${orderId}/success`,
      webhookUrl: `/api/store/payments/webhook`
    })

    return Response.json({ paymentUrl })

  } catch (error) {
    return Response.json({ error: '–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –Ω–µ —É–¥–∞–ª–æ—Å—å' }, { status: 500 })
  }
}`}
</Code>

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ —Å –≤–µ–Ω–¥–æ—Ä–∞–º–∏

// lib/payments/vendor-settlement.ts

<Code language="typescript" title="TypeScript">
{`interface VendorSettlement {
  vendorId: string
  orderId: string
  amount: number
  commission: number // –ù–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è –≤–µ–Ω–¥–µ—Ä–∞
  netAmount: number  // –°—É–º–º–∞ –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–∏
  currency: string
  status: 'pending' | 'processing' | 'completed' | 'failed'
}

export async function processVendorSettlement(orderId: string) {
  // –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
  const order = await getOrder(orderId)
  const vendorTier = await getVendorTrustTier(order.vendorId)

  // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ–º–∏—Å—Å–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è
  const commissionRates = {
    NEW: 0.20,      // 20%
    BASIC: 0.18,    // 18%
    VERIFIED: 0.16, // 16%
    TRUSTED: 0.14,  // 14%
    PREMIUM: 0.12   // 12%
  }

  const commission = order.total * commissionRates[vendorTier]
  const netAmount = order.total - commission

  // –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å —Ä–∞—Å—á–µ—Ç–∞
  await createSettlement({
    vendorId: order.vendorId,
    orderId,
    amount: order.total,
    commission,
    netAmount,
    currency: order.currency,
    status: 'pending'
  })

  // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ä—É—á–Ω–æ–π –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π)
  await processPayout(netAmount, vendorId)
}`}
</Code>

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ PCI DSS

// –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

<Code language="typescript" title="TypeScript">
{`const paymentSecurity = {
  // –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç
  noCardStorage: true,

  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö–æ—Å—Ç–∏–Ω–≥–æ–≤—ã–µ —Ñ–æ—Ä–º—ã WayForPay
  hostedPaymentForms: true,

  // –®–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  encryption: 'AES-256',

  // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏
  signatureVerification: true,

  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö
  rateLimiting: {
    paymentCreation: '10 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    webhookCalls: '–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ (—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ–¥–ø–∏—Å–∏)'
  }
}`}
</Code>

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ GDPR

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

<Code language="typescript" title="TypeScript">
{`const gdprCompliance = {
  // –ù–µ—Ç –Ω–µ–Ω—É–∂–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
  dataMinimization: true,

  // –°–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–ª–∞—Ç–µ–∂–µ–π
  explicitConsent: true,

  // –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  deletionGracePeriod: '30 –¥–Ω–µ–π',

  // –ê—É–¥–∏—Ç–æ—Ä—Å–∫–∏–π —Å–ª–µ–¥ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
  auditLogging: true
}`}
</Code>

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

<Code language="typescript" title="TypeScript">
{`export async function handlePaymentFailure(orderReference: string, reason: string) {
  // –ó–∞–ø–∏—Å–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –Ω–µ—É–¥–∞—á–∏
  await logPaymentFailure({
    orderReference,
    reason,
    timestamp: new Date(),
    userAgent: getUserAgent(),
    ipAddress: getClientIP()
  })

  // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
  await updateOrderStatus(orderReference, 'payment_failed')

  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ—É–¥–∞—á–µ
  await sendPaymentFailureEmail(orderReference)

  // –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø—Ü–∏–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏
  const retryUrl = generateRetryUrl(orderReference)
  return { retryUrl, reason }
}`}
</Code>

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ webhook

// –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook

<Code language="typescript" title="TypeScript">
{`export async function processWebhookSafely(webhookData: any) {
  try {
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å
    if (!verifySignature(webhookData)) {
      throw new Error('–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å webhook')
    }

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
    if (await isWebhookProcessed(webhookData.orderReference)) {
      return { status: 'already_processed' }
    }

    // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç–µ–∂
    await processPaymentUpdate(webhookData)

    // –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π
    await markWebhookProcessed(webhookData.orderReference)

    return { status: 'success' }

  } catch (error) {
    // –ó–∞–ø–∏—Å–∞—Ç—å –æ—à–∏–±–∫—É —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
    await logWebhookError({
      webhookData,
      error: error.message,
      timestamp: new Date()
    })

    // –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—à–∏–±–∫–∏ WayForPay
    throw new Error('–û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –Ω–µ —É–¥–∞–ª–∞—Å—å')
  }
}`}
</Code>

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

// –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

<Code language="typescript" title="TypeScript">
{`const paymentTests = {
  successfulPayment: async () => {
    const result = await testWayForPayPayment({
      amount: 299,
      currency: 'UAH',
      testMode: true
    })
    expect(result.status).toBe('approved')
  },

  failedPayment: async () => {
    const result = await testWayForPayPayment({
      amount: 0, // –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞
      currency: 'UAH'
    })
    expect(result.status).toBe('declined')
  },

  webhookProcessing: async () => {
    const webhook = generateTestWebhook('approved')
    const result = await processWebhookSafely(webhook)
    expect(result.status).toBe('success')
  }
}`}
</Code>

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–ª–∞—Ç–µ–∂–µ–π

// –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–ª–∞—Ç–µ–∂–µ–π

<Code language="typescript" title="TypeScript">
{`const paymentMetrics = {
  successRate: () => {
    // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏
    return calculatePaymentSuccessRate('24h')
  },

  averageProcessingTime: () => {
    // –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
    return getAveragePaymentLatency()
  },

  failureReasons: () => {
    // –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ—É–¥–∞—á
    return analyzePaymentFailures()
  }
}`}
</Code>

## –ß–µ–∫-–ª–∏—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –∞–∫–∫–∞—É–Ω—Ç WayForPay merchant
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- [ ] –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ webhook –∑–∞—â–∏—â–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] PCI DSS —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
- [ ] –¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –≤ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- [ ] –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- [ ] –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
- [ ] –ö–æ–º–∞–Ω–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—É—á–µ–Ω–∞
- [ ] –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –≥–æ—Ç–æ–≤–∞

---

*–≠—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Ring.*
